{% extends 'base.html' %}

{% load static %}
{% load i18n %}

{% block content %}

{% if not user.profile.isProf%}
<section class="matches">
    <div class="row">
    {% for p_match_tup in project_match_list %}
        <div class="col-md-3">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">{{ p_match_tup.0.title }}</h3>
                </div>
                <div class="panel-body">
                    <p class="lead">
                        {{ p_match_tup.0.tagline }}
                    </p>
                    <p>
                        <strong>Owner</strong>
                        <span class="label label-success">
                            {{ p_match_tup.0.creator }}
                        </span>
                    </p>
                    <p><strong>Current Members</strong>
                        {% for mem in p_match_tup.0.members.all %}
                        {% if mem.username != null %}
                        <a href="{% url 'profile' mem.username %}">
                        <span class="label label-primary">
                                <i class="fa fa-user"></i>
                                {{ mem.username }}
                        </span>
                        </a>
                        {% endif %}
                        {% endfor %}
                    </p>
                    <p>The following students may work well with this project: </p>
                    <p>
                    <ol>
                        {% for match in p_match_tup.1 %}
                        <li>
                            <a href="{% url 'profile' match.username %}">
                            <span class="label label-primary">
                                <i class="fa fa-user"></i>
                                {{ match.username }}
                            </span>
                            </a>
                        </li>
                        {% empty %}
                        <h3>
                            <font color="red">Could not find any matches for this project</font>
                        </h3>
                        {% endfor %}
                    </ol>
                    </p>
                </div>
                <div class="panel-footer clearfix">
                  {% if request.user.username == p_match_tup.0.creator %}
                    <a href="{% url 'edit_project' p_match_tup.0.slug %}">
                        <button class="btn btn-success">
                            <i class="fa fa-edit"></i>
                            Edit
                        </button>
                    </a>
                  {% endif %}
                    <a href="{% url 'view_one_project' p_match_tup.0.slug %}"
                        class="pull-right">
                        <button class="btn btn-info">
                            <i class="fa fa-eye"></i>
                            View
                        </button>
                    </a>
                </div>
            </div>
        </div>
    {% empty %}
        <div class="alert alert-warning" role="alert">
            <i class="fa fa-warning"></i>
            There are no projects yet. Go ahead and
            <a href="{% url 'create_project' %}" class="alert-link">
                create one now!
            </a>
        </div>
    {% endfor %}
    </div>
</section>

{% else %}
{# Professor match view #}
<section class="prof-matches">
{% for course in course_set %}
    <h2 class="page-header">{{course.name}}</h2>
    <div class="row">
        {% for p_match_tup in project_match_list %}
            {% if course.name == p_match_tup.0.name %}
                <div class="col-md-3">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">{{ p_match_tup.1.title }}</h3>
                        </div>
                        <div class="panel-body">
                            <p>
                                <strong>Owner</strong>
                                <span class="label label-success">
                                    {{ p_match_tup.1.creator }}
                                </span>
                            </p>
                            <p>
                                <strong>Current Members</strong>
                                {% for mem in p_match_tup.1.members.all %}
                                    {% if mem.username != null %}
                                    <a href="{% url 'profile' mem.username %}">
                                    <span class="label label-primary">
                                            <i class="fa fa-user"></i>
                                            {{ mem.username }}
                                    </span>
                                    </a>
                                    {% endif %}
                                {% endfor %}
                            </p>
                            <p>The following students may work well with this project: </p>
                            <p>
                            <ol>
                                {% for match in p_match_tup.2 %}
                                <li>
                                    <a href="{% url 'profile' match.username %}">
                                    <span class="label label-primary">
                                        <i class="fa fa-user"></i>
                                        {{ match.username }}
                                    </span>
                                    </a>
                                </li>
                                {% empty %}
                                <h3>
                                    <font color="red">Could not find any matches for this project</font>
                                </h3>
                                {% endfor %}
                            </ol>
                            </p>
                        </div>
                        <div class="panel-footer clearfix">
                          {% if request.user.username == p_match_tup.1.creator %}
                            <a href="{% url 'edit_project' p_match_tup.0.slug %}">
                                <button class="btn btn-success">
                                    <i class="fa fa-edit"></i>
                                    Edit
                                </button>
                            </a>
                          {% endif %}
                            <a href="{% url 'view_one_project' p_match_tup.0.slug %}"
                                class="pull-right">
                                <button class="btn btn-info">
                                    <i class="fa fa-eye"></i>
                                    View
                                </button>
                            </a>
                        </div>
                    </div>
                </div>
            {% endif %}
        {% empty %}
            {# If the projects list is empty, display empty message #}
            <div class="alert alert-warning" role="alert">
                <i class="fa fa-warning"></i>
                There are no projects yet in your course. Go ahead and
                <a href="{% url 'create_project' %}" class="alert-link">
                    create one now!
                </a>
            </div>
        {% endfor %}
    </div> {# end course row div #}
{% empty %}
    {# If the courses list is empty, display empty message #}
    <div class="alert alert-warning" role="alert">
        <i class="fa fa-warning"></i>
        You have no courses. Go ahead and
        <a href="{% url 'create_course' %}" class="alert-link">
            create one now!
        </a>
    </div>
{% endfor %}
</section>
{% endif %}

{% endblock content %}
